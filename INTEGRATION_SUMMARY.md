# üìä –ü—ñ–¥—Å—É–º–æ–∫: Integration API –¥–ª—è CRM —Å–∏—Å—Ç–µ–º–∏

## ‚úÖ –©–æ –±—É–ª–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ

### 1. Backend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

#### üìÅ `controllers/integrationController.js`
- –ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–∏—Ö –ª—ñ–¥—ñ–≤
- –Ü–¥–µ–Ω—Ç–∏—á–Ω–∞ –ª–æ–≥—ñ–∫–∞ —è–∫ —É Tilda webhook:
  - –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –Ω–æ–º–µ—Ä—ñ–≤ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤
  - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª—ñ–∫–∞—Ç–∏
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É (UC_HSS56X –∞–±–æ DUPLICATE)
  - WebSocket –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π

#### üìÅ `routes/integrationRoutes.js`
- –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç `/api/integration`
- –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —á–µ—Ä–µ–∑ API –∫–ª—é—á (–¥–≤–∞ —Å–ø–æ—Å–æ–±–∏):
  - `X-API-Key: your_key`
  - `Authorization: Bearer your_key`
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤

### 2. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

#### üìÑ `INTEGRATION_API.md`
–ü–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API –∑:
- –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
- –§–æ—Ä–º–∞—Ç–æ–º –∑–∞–ø–∏—Ç—ñ–≤/–≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- –ü—Ä–∏–∫–ª–∞–¥–∞–º–∏ –¥–ª—è cURL, JavaScript, Python, PHP
- –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—è–º–∏ –æ–±—Ä–æ–±–∫–∏ —Ç–∞ –±–µ–∑–ø–µ–∫–∏

#### üìÑ `INTEGRATION_QUICK_START.md`
–®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è –ø–æ—á–∞—Ç–∫—É —Ä–æ–±–æ—Ç–∏:
- 3 –ø—Ä–æ—Å—Ç–∏—Ö –∫—Ä–æ–∫–∏
- –®–≤–∏–¥–∫–∏–π —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ cURL
- –©–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º

#### üìÑ `test-integration.js`
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–π —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç:
- –¢–µ—Å—Ç —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ª—ñ–¥–∞
- –¢–µ—Å—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤
- –¢–µ—Å—Ç –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- –¢–µ—Å—Ç –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –ø–æ–ª—ñ–≤

### 3. –ü—Ä–∏–∫–ª–∞–¥–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

#### üìÅ `integration-examples/`
–ì–æ—Ç–æ–≤—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –∫–æ–¥—É –¥–ª—è:
- **JavaScript/Node.js** (`example.js`)
- **Python** (`example.py`)
- **PHP** (`example.php`)
- **README.md** - —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏:

1. **–î–æ–¥–∞–π—Ç–µ API –∫–ª—é—á –≤ `.env`:**
   ```env
   INTEGRATION_API_KEY=–≤–∞—à_–Ω–∞–¥—ñ–π–Ω–∏–π_–∫–ª—é—á
   ```
   
   –ö–ª—é—á –≤–∂–µ –¥–æ–¥–∞–Ω–æ –≤ `.env` –∑ placeholder –∑–Ω–∞—á–µ–Ω–Ω—è–º. **–û–ë–û–í'–Ø–ó–ö–û–í–û –∑–∞–º—ñ–Ω—ñ—Ç—å –π–æ–≥–æ!**

2. **–ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ –±–µ–∑–ø–µ—á–Ω–∏–π –∫–ª—é—á:**
   ```bash
   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   npm start
   ```

4. **–ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ API:**
   ```bash
   node test-integration.js
   ```

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### Endpoint
```
POST /api/integration
```

### –û–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è
```json
{
  "name": "–Ü–º'—è",
  "phone": "+380501234567"
}
```

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –ø–æ–ª—è
```json
{
  "name": "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
  "phone": "+380501234567",
  "email": "ivan@example.com",
  "sourceDescription": "–ö–∏—ó–≤",
  "utm_source": "partner_xyz"
}
```

### –í—ñ–¥–ø–æ–≤—ñ–¥—å
```json
{
  "success": true,
  "leadId": "...",
  "status": "UC_HSS56X",
  "isDuplicate": false
}
```

## üìã –©–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º

### 1. –î–æ—Å—Ç—É–ø–∏
- **URL:** `https://–≤–∞—à-–¥–æ–º–µ–Ω.com/api/integration`
- **API Key:** `[–∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π_–∫–ª—é—á]`

### 2. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
–ù–∞–¥–∞–π—Ç–µ —Ñ–∞–π–ª–∏:
- `INTEGRATION_API.md` - –ø–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- `INTEGRATION_QUICK_START.md` - —à–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç
- –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∑ `integration-examples/`

### 3. –£–Ω—ñ–∫–∞–ª—å–Ω–∞ –º—ñ—Ç–∫–∞
–ü–æ–ø—Ä–æ—Å—ñ—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **—É–Ω—ñ–∫–∞–ª—å–Ω—É –º—ñ—Ç–∫—É** –≤ –ø–æ–ª—ñ `utm_source`:
```json
{
  "utm_source": "partner_name"
}
```

–¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –≤–∞–º —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∑–≤—ñ–¥–∫–∏ –ø—Ä–∏–π—à–æ–≤ –ª—ñ–¥.

## üîê –ë–µ–∑–ø–µ–∫–∞

‚úÖ **–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:**
- –û–±–æ–≤'—è–∑–∫–æ–≤–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —á–µ—Ä–µ–∑ API –∫–ª—é—á
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
- –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤
- –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ SQL injection (Mongoose ODM)
- API –∫–ª—é—á –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è

‚ö†Ô∏è **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ
- –†–µ–≥—É–ª—è—Ä–Ω–æ –∑–º—ñ–Ω—é–π—Ç–µ API –∫–ª—é—á—ñ
- –ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ –ø—ñ–¥–æ–∑—Ä—ñ–ª—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
- –û–±–º–µ–∂—Ç–µ rate limiting –ø—Ä–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

–í—Å—ñ –∑–∞–ø–∏—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –ª–æ–≥—É—é—Ç—å—Å—è:
- ‚úÖ –û—Ç—Ä–∏–º–∞–Ω—ñ –¥–∞–Ω—ñ
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ª—ñ–¥–∞
- ‚úÖ –°—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü—ñ—ó

–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É.

## üéØ –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è
–¢–µ–ª–µ—Ñ–æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–æ—Ä–º–∞–ª—ñ–∑—É—é—Ç—å—Å—è:
```
+380 (50) 123-45-67 ‚Üí 380501234567
```

### 2. –î—É–±–ª—ñ–∫–∞—Ç–∏
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∑–∞ –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω—É:
- –ù–æ–≤–∏–π –ª—ñ–¥: `status = "UC_HSS56X"`
- –î—É–±–ª—ñ–∫–∞—Ç: `status = "DUPLICATE"`

### 3. WebSocket
–ù–æ–≤—ñ –ª—ñ–¥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ CRM –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.

### 4. –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ Tilda
–õ—ñ–¥–∏ –∑ Integration API –≤–∏–≥–ª—è–¥–∞—é—Ç—å **—ñ–¥–µ–Ω—Ç–∏—á–Ω–æ** –¥–æ –ª—ñ–¥—ñ–≤ –∑ Tilda webhook.

## üìû –ö–æ–Ω—Ç–∞–∫—Ç–∏

–ü—Ä–∏ –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—ñ –ø–∏—Ç–∞–Ω—å –∞–±–æ –ø—Ä–æ–±–ª–µ–º –∑ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –≤ `INTEGRATION_API.md`
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç `test-integration.js`
3. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
4. –ó–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ —Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

**–ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è! üéâ**

–í—Å—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω—ñ, –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω—ñ —Ç–∞ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ.
